/**
 * 
 */
var APF={log:function(a){}};APF.Namespace={register:function(d){var c=d.split(".");var a=window;for(var b=0;b<c.length;b++){if(typeof a[c[b]]=="undefined"){a[c[b]]=new Object()}a=a[c[b]]}return a}};APF.Utils={getWindowSize:function(){var b=0,a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}}}return{width:b,height:a}},getScroll:function(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft}}}return{left:b,top:a}},setCookie:function(c,e,a,h,d,g){var b=new Date();b.setTime(b.getTime());if(a){a=a*1000*60*60*24}var f=new Date(b.getTime()+(a));document.cookie=c+"="+escape(e)+((a)?";expires="+f.toGMTString():"")+((h)?";path="+h:"")+((d)?";domain="+d:"")+((g)?";secure":"")},getCookie:function(a){var f=document.cookie.split(";");var b="";var d="";var e="";var c=false;for(i=0;i<f.length;i++){b=f[i].split("=");d=b[0].replace(/^\s+|\s+$/g,"");if(d==a){c=true;if(b.length>1){e=unescape(b[1].replace(/^\s+|\s+$/g,""))}return e;break}b=null;d=""}if(!c){return null}},deleteCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},setScrollTop:function(a){if(document.body){document.body.scrollTop=a;if(document.body.scrollTop==0){if(document.documentElement){document.documentElement.scrollTop=a}}}else{if(document.documentElement){document.documentElement.scrollTop=a}}},getScrollTop:function(){return document.body?document.body.scrollTop||document.documentElement.scrollTop:document.documentElement.scrollTop},gotoScrollTop:function(f,d){var b=APF.Utils.getScrollTop(),h=0,g=0;var d=d||1;var f=f||0;var a=b>f?1:0;(function(){b=APF.Utils.getScrollTop();h=a?b-f:f-b;g=a?b-h/15*d:b+1+h/15*d;APF.Utils.setScrollTop(g);if(h<=0||b==APF.Utils.getScrollTop()){return}setTimeout(arguments.callee,10)})()}};if(typeof JSON!=="object"){JSON={}}(function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function f(n){return n<10?"0"+n:n}function this_value(){return this.valueOf()}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};Boolean.prototype.toJSON=this_value;Number.prototype.toJSON=this_value;String.prototype.toJSON=this_value}var gap,indent,meta,rep;function quote(string){rx_escapable.lastIndex=0;return rx_escapable.test(string)?'"'+string.replace(rx_escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);rx_dangerous.lastIndex=0;if(rx_dangerous.test(text)){text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());APF.Namespace.register("ajk");(function(a){ajk.inherit=function(){var f=Array.prototype.splice,c=arguments;var b=c[c.length-1];f.apply(c,[-1,1]);var e=function(){for(var g=0;g<c.length;g++){if(c[g]){c[g].apply(this,arguments)}}b.apply(this,arguments)};for(var d=0;d<c.length;d++){if(c[d]){a.extend(e.prototype,c[d].prototype)}}a.extend(e.prototype,b.prototype);return e};ajk.Observer=function(){this.ob={}};ajk.Observer.prototype.on=function(g,f){var e=g.split(" ");var d={};for(var b=0;b<e.length;b++){if(!this.ob[e[b]]){this.ob[e[b]]=[]}var c=this.ob[e[b]].push(f);d[e[b]]=c-1}return d};ajk.Observer.prototype.off=function(b,d){if(d!==undefined&&!a.isArray(d)){d=[d]}for(var c=0;c<this.ob[b].length;c++){if(d===undefined||a.inArray(c,d)>-1){this.ob[b][c]=undefined}}};ajk.Observer.prototype.trigger=function(c,d){var f;if(!this.ob[c]){return f}var b=d||[];for(var e=0;this.ob[c]&&e<this.ob[c].length;e++){if(!this.ob[c][e]){continue}var g=this.ob[c][e].apply(this,b);f=(f===false)?f:g}return f};ajk.Observer.prototype.once=function(c,e){var b=this;var d=b.on(c,function(){e.apply(this,arguments);b.off(c,d[c])})}})(jQuery);APF.Namespace.register("ajk");(function(){var logger;var siteName=(function(){var hostData=document.location.host.match(/^(\w+)\.(\w+)\./);if(hostData){return"pc"}else{return"unknown"}})();var rAf=function(callback){window.setTimeout(callback,1000/10)};ajk.Logger=logger={sojSite:"",sojPage:"",sojPageName:"",errorSite:siteName};logger.setSite=function(site){this.sojSite=site||""};logger.setPage=function(page){this.sojPage=page||""};logger.setPageName=function(pagename){this.sojPageName=pagename||""};logger.setCtid=function(ctid){this.ctid=ctid||""};logger.config={devLogURL:"//s.anjuke.test/ts.html?",logURL:"//m.anjuke.com/ts.html?",devSojURL:"//s.anjuke.test/stb",isDev:/dev|test/.test(document.domain),blackList:["Player","baiduboxapphomepagetag","onTouchMoveInPage"]};logger.isblack=function(str){var self=this;var i,reg,length,blackList=self.config.blackList;if(typeof str!=="string"){return true}for(i=0,length=blackList.length;i<length;i++){reg=new RegExp(blackList[i],"g");if(reg.test(str)){return true}}};logger.sendError=function(params){var self=this;var errorinfo="tp=error&site="+self.errorSite+"&msg=",key,url,arr=[],image,msg;if(typeof params==="string"){msg=params}if(typeof params==="object"){for(key in params){if(params.hasOwnProperty(key)){arr.push(key+":"+encodeURIComponent(JSON.stringify(params[key])))}}msg=arr.join(",")}if(self.isblack(msg)){return false}image=new Image();if(self.config.isDev){url=self.config.devLogURL+errorinfo+msg}else{url=self.config.logURL+errorinfo+msg}image.src=url;return true};var getScreen=function(){var sinfo={};sinfo.w=$(window).width().toString();sinfo.h=$(window).height().toString();sinfo.r=(window.devicePixelRatio&&window.devicePixelRatio>=2?1:0).toString();getScreen=function(){return sinfo};return sinfo};logger.sendSoj=function(op){var self=this;var _site=op.site||self.sojSite,soj=new SiteTracker(),t_params;if(op.customparam){soj.setCustomParam(op.customparam)}if(self.config.isDev){t_params={target_url:self.config.devSojURL}}var _page=op.page||self.sojPage,_ctid=self.ctid,_pageName=op.pageName||self.sojPageName||_page;soj.setPage(_page);soj.setPageName(_pageName);soj.setSite(_site);soj.setScreen(getScreen());soj.setNCtid(_ctid);soj.setReferer(op.r||document.referrer);if(op.NGuid){soj.setNGuid(op.NGuid)}if(op.NUid){soj.setNUid(op.NUid)}if(op.h){if(!t_params){t_params={}}t_params.h=op.h}soj.track(t_params);try{if(!/npv/.test(_site)){var trackUrl=soj.getParams();delete trackUrl.cp;delete trackUrl.sc;window._trackURL=JSON.stringify(trackUrl);loadTrackjs()}}catch(e){}function loadTrackjs(){var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src="//tracklog.58.com/referrer_anjuke_pc.js?_="+Math.random();var b=document.body;s.onload=function(){soj.setSite(_site+"-npv");soj.setPage(_page+"_tracklog");soj.setPageName(_pageName+"_tracklog");soj.track(t_params)};s.onerror=function(){soj.setSite(_site+"-npv");soj.setPage(_page+"_tracklog_error");soj.setPageName(_pageName+"_tracklog_error");soj.track(t_params)};b.appendChild(s)}};logger.addLinkSoj=function(selector,attr,param){$("body").on("click",selector,function(e){var soj=$(this).data(attr||"soj")||$(this).attr(attr||"_soj"),_soj=$.trim(soj),href=$.trim($(this).attr("href")),_param=param||"from",_target=$(this).attr("target"),_hasTarget=_target!==undefined,_href;if(!_soj){return}if(!href){return}if(href.toLowerCase().indexOf("javascript")===0){return}e.preventDefault();e.stopPropagation();href=href.replace(/(&from=(.)*$)|(\?from=(.)*$)/,"");_href=(href.indexOf("?")!==-1)?href+"&"+_param+"="+_soj:href+"?"+_param+"="+_soj;if(_hasTarget){if(!
/*@cc_on!@*/
0){var winoper=window.open(_href,_target);winoper&&winoper.focus()}else{var _el=document.createElement("a");_el.href=_href;_el.target=_target;$(_el).appendTo("body").get(0).click();$(_el).remove()}}else{location.href=_href}})};logger.Exposure=function(op){var defaults={site:"",trackTag:"data-trace",delay:50,page:"",pageName:"",NUid:"",NGuid:"",prefix:""};this.ops=$.extend(defaults,op);this.domCache=[];this.pageViewHeight=$(window).height();this.timer=null;this.dataCache=[];this.expStatus=false;this.init()};logger.Exposure.prototype={constructor:logger.Exposure,add:function(list){var _this=this;this.expStatus=true;list.each(function(index,el){_this.domCache.push($(el))})},init:function(){var wd=$(window),self=this;wd.resize($.proxy(this.resize,this));wd.on("beforeunload",$.proxy(this.beforeunload,this));rAf(scroll);function scroll(){rAf(scroll);if(!self.expStatus){return}clearTimeout(self.timer);if(self.domCache.length===0){self.expStatus=false;self.buildData();return}self.timer=setTimeout(function(){$.proxy(self.addData,self)()},self.ops.delay)}},resize:function(){this.pageViewHeight=$(window).height()},beforeunload:function(){this.buildData()},scroll:function(){},sendExp:function(result){logger.sendSoj({NGuid:this.ops.NGuid,NUid:this.ops.NUid,site:this.ops.site,page:this.ops.prefix+this.ops.page,pageName:this.ops.prefix+this.ops.pageName,customparam:result})},addData:function(){var pageViewHeight=this.pageViewHeight,topY=$(window).scrollTop(),botY=topY+pageViewHeight,_this=this;if(this.domCache.length===0){return}$.each(this.domCache,function(index,val){var _topY,attr;if(!val){return}_topY=val.offset?val.offset().top:0;if(_topY>topY&&_topY<botY){attr=val.attr(_this.ops.trackTag);if(attr){_this.dataCache.push(attr)}delete _this.domCache[index]}});this.buildData()},buildData:function(){var _this=this,result={},r=[],exp,key,length,i;if(this.dataCache.length===0){return}exp=eval("(["+this.dataCache.join(",")+"])");this.dataCache=[];for(i=0,length=exp.length;i<length;i++){for(key in exp[i]){if(!result[key]){result[key]=[]}result[key].push(exp[i][key])}}for(key in result){r.push('"'+key+'":['+result[key].join(",")+"]")}this.sendExp('{"exposure":{'+r.join(",")+"}}");$.each(this.domCache,function(index,val){if(!val){_this.domCache.splice(index,1)}})}};window.onerror=function(msg,url,line){logger.sendError({message:msg,url:url,line:line})};$(function(){logger.addLinkSoj("a[_soj]")})})();APF.Namespace.register("ajk");(function(a){ajk.Modal=ajk.inherit(ajk.Observer,function(c){var b=this;b.op=a.extend({},ajk.Modal._default,c);b.op.ie6=/MSIE 6/.test(navigator.userAgent)});ajk.Modal._default={modalClass:"",con:"",hd:"",title:"",bd:"",ft:"",width:560,height:"",pos:{top:undefined,left:undefined},mask:true,duration:200};ajk.Modal.prototype._create=function(){var j=this,e=j.op;e.modal=a('<div class="xf-modal"></div>');e.modalMask=a('<div class="modal-mask"></div>');e.modalIfr=a('<iframe class="modal-ifr"></iframe>');e.modalCover=a('<div class="modal-cover"></div>');var g=a('<div class="shadow"></div>'),h=a('<a href="javascript:" class="md-close iconfont">&#xE073;</a>'),b=a('<div class="con"></div>').append(a(e.con).show()),d=a('<div class="hd"></div>').append(a(e.hd).show()),f=a('<div class="bd"></div>').append(a(e.bd).show()),c=a('<div class="ft"></div>').append(a(e.ft).show());!e.hd&&e.title&&d.html('<h3 class="title">'+e.title+"</h3>");e.con||a().add((e.hd||e.title)&&d).add(e.bd&&f).add(e.ft&&c).appendTo(b);b.add(h).appendTo(e.modal);e.modalClass&&e.modal.addClass(e.modalClass);b.css({width:e.width,height:e.height});e.modalCover.append(e.modal).appendTo("body");h.on("click.modal",function(){j.close()});var k=a(document).height();e.mask&&e.modalMask.css({height:k}).appendTo("body");e.ie6&&e.modalIfr.css({height:k}).appendTo("body")};ajk.Modal.prototype.center=function(c,d){var j=this,f=j.op,g=c.outerWidth(),b=c.outerHeight(),e=a(window).height();if(f.ie6||b>e){a("html").css({overflow:"hidden"});f.modalCover.css({overflow:"auto"})}else{a("html").css({overflow:""});f.modalCover.css({overflow:"hidden"})}if(f.pos.top===undefined||f.pos.left===undefined){var k=-parseInt(g/2,10),h=-parseInt(b/2,10);if(b>e){h=-parseInt(e/2,10)}c.animate({"margin-top":h,"margin-left":k},d)}else{c.animate(f.pos,d)}};ajk.Modal.prototype.open=function(){var b=this,e=b.op,d=window.undefined;function c(f){e.ie6&&e.modalCover.css({top:a(window).scrollTop()});b.center(e.modal,f)}if(a(b).trigger("openBefore")!==false){(e.modal===d)&&b._create();c(0);e.modalCover.add(e.modalMask).add(e.modalIfr).css({visibility:"visible"});a(window).off("resize.modal").on("resize.modal",function(){e.timer&&clearTimeout(e.timer);e.timer=setTimeout(function(){c(e.duration)},200)});a(b).trigger("openAfter")}};ajk.Modal.prototype.close=function(){var b=this,c=b.op;if(a(b).trigger("closeBefore")!==false){if(c.modal!==undefined){c.modalCover.css({overflow:"hidden"}).add(c.modalMask).add(c.modalIfr).css({visibility:"hidden"});a("html").css({overflow:""});a(window).off("resize.modal");a(b).trigger("closeAfter")}}}})(jQuery);(function(b){var a=new ajk.Modal({modalClass:"modal-custom quit_dialog",title:"提示",bd:b(".quit-content"),ft:b(".quit-btn"),width:"460",height:"239"});b(".quit").on("click",function(c){c.preventDefault();a.open()});b(".quit-btn").find(".sure").on("click",function(){a.close()});b(".quit-btn").find(".cancel").on("click",function(){a.close()})})(jQuery);APF.Namespace.register("ajk.UserCenter");(function(a){ajk.UserCenter.Prorile=function(b){this.op={$modifyNameBtn:a(".modify-name-btn"),$boundBtn:a(".bound").find("button"),$tip:a(".wrap-tip"),$nameInput:a(".name"),$nameBox:a(".name-box"),$nameOk:a(".name-ok"),$nameErrorTip:a(".name-error"),$sureNameBtn:a(".modify-name-btn").find(".sure"),$name:a(".name").find(".value"),unBoundUrl:"/ajax/unBind",boundUrl:"/user/bindExt",modifyNameUrl:"/ajax/modifyNickname",nickName:"",isSure:false,clearTip:b};this.modifyNameModal=new ajk.Modal({modalClass:"modal-custom modify_name_dialog",title:"修改昵称",bd:a(".modify-name"),ft:a(".modify-name-btn"),width:"460",height:"251"});this.init()};ajk.UserCenter.Prorile.prototype={init:function(){if(this.op.clearTip){this.disapearTip()}this.modifyNickName();this.accountExt()},modifyNickName:function(){var b=this;this.showNameDialog();this.op.$modifyNameBtn.find(".cancel").on("click",function(){b.modifyNameModal.close();return});this.changeNickName()},showNameDialog:function(){var b=this;a(".name").find("button").click(function(c){c.preventDefault();b.modifyNameModal.open();b.initForm();b.op.$nameInput.trigger("focus")})},initForm:function(){this.op.$nameInput.val("");this.clearShow()},changeNickName:function(){this.modifyNameFocusBlur();this.checkNickName();this.submitNameChange()},modifyNameFocusBlur:function(){var b=this;this.op.$nameInput.focus(function(){b.op.$nameBox.addClass("cur")});this.op.$nameInput.blur(function(){b.op.$nameBox.removeClass("cur")})},checkNickName:function(){var b=this;this.op.$nameInput.keyup(function(){var c=this.value.length;if(c===0){b.clearShow();return}if(this.value.length>12){b.showError("昵称不能超过12个字");return}b.op.nickName=this.value;var d=/^[0-9a-zA-Z\u4E00-\u9FA5]*$/i.test(b.op.nickName);if(d){b.op.$nameErrorTip.hide();b.op.$nameOk.show();b.op.$nameBox.removeClass("error");b.op.$sureNameBtn.removeClass("disable")}else{b.showError("昵称不能有符号，只能包含：中文、字母、数字")}})},clearShow:function(){this.op.$nameOk.hide();this.op.$nameBox.removeClass("error");this.op.$nameErrorTip.hide()},showError:function(b){this.op.$nameOk.hide();this.op.$nameBox.addClass("error");this.op.$nameErrorTip.text(b).show()},submitNameChange:function(){var b=this;this.op.$sureNameBtn.click(function(g){var f=a(this),d=f.data("status");g.preventDefault();if(b.op.nickName===""){b.showError("昵称不能为空");return}var c=/^[0-9a-zA-Z\u4E00-\u9FA5]*$/i.test(b.op.nickName);if(c){b.op.$nameErrorTip.hide();b.op.$nameBox.removeClass("error");b.op.$nameOk.show();b.op.$sureNameBtn.removeClass("disable")}else{b.showError("昵称不能有符号，只能包含：中文、字母、数字");return}if(d){return}a(this).data("status",true);a.ajax({type:"post",dataType:"json",url:b.op.modifyNameUrl,data:{nickname:b.op.nickName},success:function(e){f.data("status",false);if(e.code!==0){b.showError(e.message);return}b.modifyNameModal.close();b.op.$name.text(b.op.nickName);a(".info-sup .name").text(b.op.nickName);b.op.$nameInput.val("");b.op.$nameOk.hide();return},error:function(e){}})})},accountExt:function(){var b=this;b.op.$boundBtn.click(function(c){c.preventDefault();if(!b.op.$boundBtn.hasClass("disable")){location.href=b.op.boundUrl+"?"+a.param({type:"weixin"});return}a.ajax({type:"post",dataType:"json",url:b.op.unBoundUrl,data:{type:"weixin"},success:function(d){if(d.code===0){a(".center-tip").text("完成解绑");a(".wrap-tip").addClass("tip-show");b.disapearTip();location.href="/user/profile"}else{a(".center-tip").text(d.message);a(".wrap-tip").addClass("tip-show");b.disapearTip()}},error:function(d){}})})},disapearTip:function(){var b=this;setTimeout(function(){b.op.$tip.css("display","none")},4000)}}})(jQuery);